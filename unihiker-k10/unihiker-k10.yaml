esphome:
  name: unihiker-k10

esp32:
  board: esp32s3box
  framework:
    type: esp-idf

# 启用日志
logger:

# SPI总线配置（在此处设置SPI速度）
spi:
  id: spi_bus  # 定义SPI总线ID，供显示屏引用
  clk_pin: GPIO12
  mosi_pin: GPIO21
  frequency: 40MHz  # 将原spi_speed移至此处

# 屏幕配置（修正平台参数）
display:
  - platform: ili9xxx
    model: ILI9341
    cs_pin: GPIO14
    dc_pin: GPIO13
    rotation: 180
    invert_colors: false  # 添加必填项（根据硬件实际情况调整true/false）
    spi_id: spi_bus  # 引用上面定义的SPI总线
    id: k10_display

    # 基础图形绘制
    lambda: |-
      // 1. 绘制白色背景
      it.fill(lv_color_hex(0xFFFFFF));

      // 2. 绘制彩色矩形（红色边框，黄色填充）
      it.rectangle(20, 20, 100, 60, lv_color_hex(0xFF0000), lv_color_hex(0xFFFF00));

      // 3. 绘制蓝色圆形（线宽3）
      it.circle(180, 50, 30, lv_color_hex(0x0000FF), 3);

      // 4. 绘制绿色斜线（线宽2）
      it.line(20, 100, 220, 200, lv_color_hex(0x00FF00), 2);

      // 5. 绘制紫色点矩阵
      for (int x = 20; x < 220; x += 15) {
        for (int y = 220; y < 300; y += 15) {
          it.pixel(x, y, lv_color_hex(0x800080));
        }
      }

# 背光控制
i2c:
  scl: GPIO48
  sda: GPIO47
  frequency: 100kHz

output:
  - platform: gpio
    id: screen_backlight
    pin:
      i2c_id: default_i2c
      address: 0x20
      register: 0x02
      bit: 0
    inverted: false

switch:
  - platform: output
    name: "Screen Backlight"
    output: screen_backlight
    restore_mode: ALWAYS_ON