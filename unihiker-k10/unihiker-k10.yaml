esphome:
  name: k10-screen-test-only
  platform: ESP32
  board: esp32s3box

# 仅保留屏幕所需核心配置
spi:
  clk_pin: GPIO12    # 对应SPI_bus = SPI.Bus(sck=12)
  mosi_pin: GPIO21   # 对应spi_bus = SPI.Bus(mosi=21)
  miso_pin: -1       # 屏幕不使用MISO（与代码中miso=-1一致）

display:
  - platform: ili9341
    model: TFT_240x320
    cs_pin: GPIO14    # 对应display_bus = lcd_bus.SPIBus(cs=14)
    dc_pin: GPIO13    # 对应display_bus = lcd_bus.SPIBus(dc=13)
    reset_pin: -1     # 代码中未使用复位引脚
    rotation: 180     # 对应set_rotation(lv.DISPLAY_ROTATION._180)
    spi_speed: 40MHz  # 对应freq=40000000
    id: k10_display

    pages:
      - id: test_page
        lambda: |-
          // 绘制纯色背景
          it.fill(lv_color_hex(0xFFFFFF));

          // 绘制测试文本（匹配代码中默认字体）
          it.print(10, 20, id(default_font), lv_color_hex(0xFF0000), "K10 Screen Test");
          it.print(10, 50, id(small_font), lv_color_hex(0x000000), "No WiFi/MQTT Needed");
          it.print(10, 70, id(small_font), lv_color_hex(0x000000), "240x320 Resolution");

          // 绘制基础图形（验证绘图功能）
          it.rectangle(10, 100, 80, 50, lv_color_hex(0x00FF00), lv_color_hex(0xFFFF00));  // 矩形
          it.circle(180, 125, 25, lv_color_hex(0x0000FF), 2);  // 圆形
          it.line(10, 180, 230, 180, lv_color_hex(0x800080), 3);  // 线条

# 字体配置（无需复杂字体，基础字体即可）
font:
  - file: "fonts/dejavu-sans.ttf"
    id: default_font
    size: 18
  - file: "fonts/dejavu-sans.ttf"
    id: small_font
    size: 14

# 背光控制（必须保留，否则屏幕可能不亮）
i2c:
  scl: GPIO48   # 对应I2C(0, scl=Pin(48))
  sda: GPIO47   # 对应I2C(0, sda=Pin(47))
  frequency: 100kHz

output:
  - platform: gpio
    id: screen_backlight
    pin:
      i2c_id: default_i2c
      address: 0x20    # 代码中myi2c操作的地址0x20
      register: 0x02   # 背光控制寄存器0x02
      bit: 0           # 对应(temp[0] | 0x01)控制bit0
    inverted: false

switch:
  - platform: output
    name: "Screen Backlight"
    output: screen_backlight
    restore_mode: ALWAYS_ON  # 上电自动开启背光